{
  "pluginAlias": "HomebridgeVirtualSwitches",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Name",
        "type": "string",
        "required": true,
        "default": "HomebridgeVirtualSwitches",
        "description": "This name will be displayed as child bridge name and in logs."
      },
      "platform": {
        "type": "string",
        "title": "Platform Name",
        "default": "HomebridgeVirtualSwitches",
        "description": "Do not change Platform name!"
      },
      "devices": {
        "type": "array",
        "title": "Virtual Switches",
        "items": {
          "type": "object",
          "title": "Switch Configuration",
          "properties": {
            "Name": {
              "type": "string",
              "title": "Switch Name",
              "required": true
            },
            "NormallyClosed": {
              "type": "boolean",
              "title": "Normally On Switch",
              "default": false,
              "description": "Check to make the switch normally-closed (on). Default is normally-open (off)."
            },
            "SwitchStayOn": {
              "type": "boolean",
              "title": "Stateful",
              "default": false,
              "description": "Check to make the switch stateful (disable timer)."
            },
            "Time": {
              "type": "integer",
              "title": "Timer (in ms)",
              "default": 5000,
              "description": "Duration in milliseconds that the switch stays after triggering. Only relevant if the switch is not stateful.",
              "condition": {
                "functionBody": "return model.devices[arrayIndices[0]].SwitchStayOn === false;"
              }
            },
            "UseLogFile": {
              "type": "boolean",
              "title": "Monitor Log File",
              "default": false,
              "description": "Check if this switch will be triggered by log file keywords/phrases."
            },
            "LogFilePath": {
              "type": "string",
              "title": "Log File Path",
              "default": "/var/lib/homebridge/homebridge.log",
              "description": "Enter the full path to the log file.",
              "condition": {
                "functionBody": "return model.devices[arrayIndices[0]].UseLogFile === true;"
              }
            },
            "Keywords": {
              "type": "string",
              "title": "Keywords",
              "description": "Enter comma separated keywords/phrases that will trigger the switch when they appear in the log file (case independent).",
              "condition": {
                "functionBody": "return model.devices[arrayIndices[0]].UseLogFile === true;"
              }
            },
            "EnableStartupDelay": {
              "type": "boolean",
              "title": "Enable Startup Delay",
              "default": false,
              "description": "Delay the switch activation after Homebridge starts."
            },
            "StartupDelay": {
              "type": "integer",
              "title": "Startup Delay (in ms)",
              "default": 3000,
              "description": "Time in milliseconds to delay the switch start after Homebridge restarts.",
              "condition": {
                "functionBody": "return model.devices[arrayIndices[0]].EnableStartupDelay === true;"
              }
            },
            "RememberState": {
              "type": "boolean",
              "title": "Restart in last known state",
              "default": false,
              "description": "Switch will restart in its last known state (only for non-log-monitoring stateful switches)."
            }
          },
          "required": [
            "Name"
          ]
        }
      }
    },
    "required": [
      "name",
      "platform",
      "devices"
    ]
  },
  "layout": [
    
    {
      "type": "array",
      "key": "devices",
      "title": "Devices",
      "description": "",
      "buttonText": "Add",
      "expandable": true,
      "expanded": true,
      "items": [
        {
          "type": "fieldset",
          "items": [
            "devices[].Name",
            "devices[].Time",
            "devices[].SwitchStayOn",
            "devices[].NormallyClosed",
            "devices[].UseLogFile",
            "devices[].LogFilePath",
            "devices[].Keywords",
            "devices[].EnableStartupDelay",
            "devices[].StartupDelay",
            "devices[].RememberState"
          ]
        }
      ]
    },
    {
      "type": "fieldset",
      "title": "Plugin config",
      "description": "",
      "expandable": true,
      "expanded": false,
      "items": [
        "name"
      ]
    }
  ]
}
